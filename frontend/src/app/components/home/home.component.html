<div class="split-screen">
  <!-- Admin Edit Controls -->
  <div class="admin-controls" *ngIf="isAdmin">
    <div class="admin-buttons">
      <button class="add-btn primary" (click)="logout()">Logout</button>
      <button
        *ngIf="!editMode"
        class="edit-toggle-btn"
        (click)="toggleEditMode()">
        Edit Content
      </button>
      <ng-container *ngIf="editMode">
        <button class="save-btn" (click)="saveChanges()">Save Changes</button>
        <button class="cancel-btn" (click)="cancelEdit()">Cancel</button>
      </ng-container>
    </div>
  </div>

  <!-- Left side - Image -->
  <div class="image-section">
    <!-- Cover Image Edit Form - Moved above the image -->
    <div *ngIf="editMode" class="image-edit-form">
      <input
        type="file"
        accept="image/*"
        (change)="onCoverImageSelected($event)"
        class="file-input">
      <small class="file-info" *ngIf="editForm.coverImage">
        Selected: {{ editForm.coverImage.name }}
      </small>
    </div>

    <img [src]="backendUrl  + coverImage" alt="Architectural Design" class="hero-image">
  </div>

  <!-- Right side - Content -->
  <div class="content-section">
    <div class="content-wrapper">
      <h1>Meeta Shah</h1>
      <h2>Architect</h2>

      <!-- View Mode -->
      <ng-container *ngIf="!editMode">
        <p class="subtitle">{{ tagline }}</p>
        <div class="description">
          <p>{{ subtext }}</p>
        </div>
      </ng-container>

      <!-- Edit Mode -->
      <div *ngIf="editMode" class="edit-form">
        <div class="form-group">
          <label for="tagline">Tagline</label>
          <input
            type="text"
            id="tagline"
            [(ngModel)]="editForm.tagline"
            name="tagline"
            required>
        </div>

        <div class="form-group">
          <label for="subtext">Subtext</label>
          <textarea
            id="subtext"
            [(ngModel)]="editForm.subtext"
            name="subtext"
            rows="3"
            required></textarea>
        </div>
      </div>

      <div class="cta-buttons">
        <button class="primary-btn" (click)="scrollToProjects()">View Projects</button>
      </div>
    </div>
  </div>
</div>

<div class="intro-section">
  <div class="container">
    <div class="about-wrapper">
      <div class="about-header">
        <h3>About</h3>
      </div>

      <div class="about-content">

        <!-- About Text Section -->
        <div class="about-text">
          <!-- View Mode -->
          <div *ngIf="!editMode" class="about-description">
            <p [innerHTML]="about | nl2br"></p>
          </div>

          <!-- Edit Mode -->
          <div *ngIf="editMode" class="edit-form">
            <div class="form-group">
              <label for="about">About Content</label>
              <textarea
                id="about"
                [(ngModel)]="editForm.about"
                name="about"
                rows="6"
                required></textarea>
            </div>
          </div>
        </div>

        <!-- Headshot Section -->
        <div class="headshot-container">
          <div class="headshot-image">
            <img src="headshot.png" alt="Meeta Shah - Architect" class="headshot">
            <div class="headshot-frame"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="projects-section" id="projects">
  <div class="container">
    <!-- Loading State -->
    @if(loading) {
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>Loading projects...</p>
      </div>
    }

    <!-- Error State -->
    @if(error && !loading) {
      <div class="error-state">
        <h3>Oops! Something went wrong</h3>
        <p>{{error}}</p>
        <button class="retry-btn" (click)="retryLoad()">Try Again</button>
      </div>
    }

    <!-- Projects Content -->
    @if(!loading && !error) {
      @for(projectCategory of projectCategories; track projectCategory.id) {
        <div class="project-category">
          <div class="category-header">
            <h3>{{projectCategory.name}}</h3>
            <p class="category-description">{{projectCategory.description}}</p>
          </div>

          <div class="projects-grid">
            @for(project of projectCategory.projects; track project.id) {
              <div class="project-card" (click)="onProjectClick(project)">
                @if(project.images && project.images.length > 0) {
                  <div class="project-image-header">
                    <img src="{{ backendUrl + project.images[0].src}}" alt="{{project.images[0].alt}}" class="project-image">
                    <div class="image-overlay"></div>
                  </div>
                }

                <div class="project-content">
                  <div class="project-header">
                    <h4>{{project.name}}</h4>
                    <span class="completion-year">{{project.constructionCompleted}}</span>
                  </div>

                  <div class="project-details">
                    <p class="project-description">{{project.description}}</p>
                    <div class="project-role">
                      <strong>Role:</strong> {{project.role}}
                    </div>
                    <div class="project-specs">
                      {{project.details}}
                    </div>
                  </div>
                </div>

                <div class="project-hover-overlay">
                  <div class="view-project-text">View Project</div>
                  <div class="image-count" *ngIf="project.images && project.images.length > 0">
                    {{project.images.length}} images
                  </div>
                </div>
              </div>
            }
          </div>
        </div>
      }
    }
  </div>
</div>
<div class="w-100">
  <app-hobbies></app-hobbies>
</div>

